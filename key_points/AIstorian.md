# Мультиагентный подход к генерации исторических биографий

В данной статье представлена система AIstorian - инновационное решение для автоматической генерации биографий исторических личностей, разработанное Huawei совместно с Чжэцзянским университетом. Этот обзор рассматривает ключевые аспекты предложенной системы, её архитектуру, методы и экспериментальные результаты.
## Проблематика и концепция решения

Генерация биографий представляет собой специализированную форму абстрактного суммирования, которая сталкивается с уникальными трудностями, не решаемыми существующими моделями больших языков (LLM). Авторы выделяют три ключевых проблемы:

1. **Стилистическое соответствие** - необходимость строгого следования специфическим языковым стилям и исторической терминологии, что особенно сложно для моделей при работе с классическим китайским языком1.
    
2. **Фактологическая точность** - биографии не допускают фактических ошибок, но LLM склонны к галлюцинациям, генерируя правдоподобный, но противоречащий фактам контент1.
    
3. **Фрагментация информации** - детальная информация об исторических личностях рассредоточена по множеству документов, что создаёт проблемы для традиционных методов извлечения и представления знаний1.
    

Для преодоления этих вызовов авторы разработали AIstorian - комплексную систему, включающую механизм генерации на основе графов знаний (KG-powered RAG) и мультиагентный подход для обнаружения и исправления галлюцинаций.

## Архитектура системы AIstorian

## Общая структура

Система AIstorian функционирует в двух режимах:

- **Оффлайн-процесс**: включает построение индекса на основе графа знаний и дообучение языковой модели
    
- **Онлайн-процесс**: генерация биографии с извлечением релевантной информации и проверкой ошибок в реальном времени
    

## KG-based RAG механизм

Данный механизм обеспечивает эффективное извлечение и организацию биографической информации через три основных этапа:

1. **Pattern-enhanced text chunking** - разделение документов на фрагменты с использованием in-context learning без дополнительного обучения модели. Этот подход использует выявленные структурные паттерны в исторических документах, где представление личностей следует стандартизированному формату.
    
2. **Regex-driven relation extraction** - извлечение биографических фактов в виде триплетов (субъект-отношение-объект). Система использует LLM для генерации регулярных выражений, которые затем применяются к фрагментам текста для извлечения структурированной информации.
    
3. **Построение графа знаний** - создание графа, где узлами выступают сущности (имена, места, даты), а ребрами - отношения между ними. Каждый узел графа связан с исходным фрагментом текста, что обеспечивает прослеживаемость информации.
    

При получении запроса на генерацию биографии система идентифицирует релевантные узлы графа и извлекает связанные с ними текстовые фрагменты в качестве референсов. Этот подход демонстрирует 50% улучшение точности и 21% улучшение полноты извлечения по сравнению с существующими методами.

## Error-aware Generation с мультиагентами

Для минимизации ошибок в генерируемых биографиях авторы предлагают двухэтапный подход:

1. **Оффлайн дообучение LLM**:
    
    - **Data augmentation-enhanced supervised fine-tuning** - стратегия обогащения тренировочных данных, включающая перестановку ключевых биографических фактов и введение "отвлекающих документов".
        
    - **Stylistic preference optimization (StylePO)** - дальнейшая настройка модели для соответствия высокой фактологической точности и классическому китайскому языковому стилю с использованием алгоритма SimPO.
        
2. **Онлайн мультиагентная генерация**:
    
    - **Verifier** - агент, проверяющий, подтверждается ли каждый "атомарный факт" в генерации извлеченными референсами.
        
    - **Router** - определяет типы ошибок ("Not-included" или "Not-supported") и оптимальные методы их коррекции.
        
    - **Solvers** - специализированные решатели для различных типов ошибок, включая:
        
        - Era-conflict Solver - для ошибок, связанных с хронологией событий
            
        - Ref-conflict Solver - для конфликтов в источниках
            
        - Knowledge-lack Solver - для ошибок, вызванных недостатком экспертных знаний
            
        - Alias-conflict Solver - для проблем с различными именами исторических личностей
            
        - Solver for others - для прочих типов ошибок
            

## Экспериментальная оценка и результаты

## Методология экспериментов

Авторы оценивали систему на датасете Jinshi, содержащем 173 китайские исторические личности с эталонными биографиями и корпусом древних китайских текстов объемом около 220 тысяч иероглифов.

Для сравнения использовались шесть базовых моделей, включая mLongT5_large, Qwen2.5-72B-Instruct-AWQ и специализированные RAG-системы. Оценка включала метрики качества генерации (ROUGE-1/2/L), частоту галлюцинаций и среднюю ошибку атомарного факта.

## Основные результаты

1. **Качество генерации биографий**:
    
    - AIstorian достигает значения ROUGE-L 80.54, что на 11.4%-20.6% превосходит предыдущие SOTA методы.
        
    - Система демонстрирует снижение частоты галлюцинаций на 47.6% и уменьшение средней ошибки атомарного факта в 3.8 раза.
        
2. **Эффективность KG-based RAG**:
    
    - Механизм KG-based RAG показывает значительные улучшения по сравнению с существующими подходами: точность - 0.936, полнота - 0.944, F1-score - 0.923.
        
3. **Влияние компонентов системы**:
    
    - Абляционные исследования подтверждают положительное влияние мультиагентного подхода на снижение частоты галлюцинаций, но также отмечают его потенциальное негативное влияние на креативность (измеряемую метриками ROUGE).
        
    - StylePO улучшает показатели ROUGE и уменьшает ошибки атомарного факта на 35%.
        
4. **Эффективность по времени**:
    
    - Система достигает миллисекундной скорости (0.00146 с) при онлайн-извлечении информации, значительно превосходя TongGu (169.101 с) и GraphRAG (1.68 с).
        
    - Этап генерации требует большего времени (1236 с, в среднем 36.35 с на биографию) из-за мультиагентного подхода, но это окупается повышенной точностью.
![Alt text](https://github.com/rocoss/Awesome-RAG/blob/main/images/Pasted%20image%2020250509145544.png)

## Заключение и практические выводы

AIstorian представляет собой инновационную систему для точной генерации исторических биографий, объединяющую преимущества графов знаний и мультиагентного подхода. Ключевые достижения системы:

1. **Высокая фактологическая точность** - значительное снижение галлюцинаций и фактических ошибок делает систему применимой для исторических исследований.
    
2. **Стилистическое соответствие** - успешное сохранение стилистических характеристик классического китайского языка благодаря двухэтапному обучению модели.
    
3. **Эффективная обработка фрагментированной информации** - KG-based RAG обеспечивает структурированный подход к извлечению и организации информации из множества источников.
    

Система AIstorian демонстрирует практический потенциал для применения в музеях и исторических архивах, освобождая историков от рутинных задач сбора и обработки информации1. Это первая известная авторам работа по созданию системы для генерации исторических биографий из масштабного корпуса текстов1.
