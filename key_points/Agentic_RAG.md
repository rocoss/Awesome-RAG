![main_agentic_rag.png](https://github.com/aishwaryanr/awesome-generative-ai-guide/blob/main/resources/img/main_agentic_rag.png)
# Агентное дополненное генерирование с извлечением (Agentic RAG)

Агентное дополненное генерирование с извлечением или Агентный RAG (Agentic RAG) быстро становится популярным подходом в искусственном интеллекте, поскольку он объединяет сильные стороны систем извлечения информации с интеллектуальным принятием решений агентами. Это позволяет большим языковым моделям (LLM) получать данные в режиме реального времени и использовать их для улучшения своих ответов. Благодаря этому такие системы становятся более гибкими и могут справляться с более сложными, постоянно меняющимися задачами.

## Понимание RAG и агентов

**Дополненное генерирование с извлечением (Retrieval Augmented Generation, RAG)** - это метод, используемый для улучшения больших языковых моделей путем предоставления им доступа к данным в реальном времени. Обычно LLM полагаются только на данные, на которых они были обучены, и эти данные могут устаревать. RAG решает эту проблему, позволяя моделям извлекать информацию из внешних источников, таких как базы данных или поиск в интернете. Таким образом, когда модели задают вопрос, она может получить свежие, релевантные данные и объединить их со своими знаниями для создания более точного и полезного ответа. RAG особенно ценен в таких областях, как поддержка клиентов или финансы, где актуальная информация имеет решающее значение[1].

**Агенты**, с другой стороны, представляют собой системы, которые могут самостоятельно принимать решения и действовать. В искусственном интеллекте агенты используются для управления задачами и процессами, автоматически адаптируясь к любой ситуации, в которой они находятся. Они могут оценивать, что нужно сделать, выбирать лучший способ сделать это, а затем выполнять задачу, что делает их очень гибкими и эффективными[1].

**Встречайте Агентный RAG!**

## Что такое Агентный RAG?

Когда **RAG и агенты** объединяются, агенты берут на себя управление всем процессом, решая, как и когда извлекать данные и как использовать их для генерации наилучшего возможного ответа. Вместо простого извлечения информации агенты делают умный выбор относительно того, откуда получать данные, что наиболее важно и как интегрировать это в ответ LLM. Результатом является система, которая может обрабатывать более сложные запросы и давать ответы, которые являются точными и адаптированными к конкретной ситуации[1].

Таблица ниже дает четкий обзор того, чем отличаются **Агенты**, **RAG** и **Агентный RAG** с точки зрения их ключевых особенностей и функциональности:

![differences.png](https://github.com/aishwaryanr/awesome-generative-ai-guide/blob/main/resources/img/differences.png)

Давайте рассмотрим пример, чтобы понять, как Агентный RAG работает в режиме реального времени. Предположим, вы используете чат-бота службы поддержки клиентов, работающего на Агентном RAG, для решения проблемы с вашим интернет-сервисом. Запрос, который вы вводите: "Почему мой интернет медленный по вечерам?"[1].

#### Пошаговый разбор:

1. **Запрос пользователя**
    - Вы вводите свой запрос в чат-бот: "Почему мой интернет медленный по вечерам?"
    - Запрос получен системой, которая активирует интеллектуального агента для определения дальнейших действий[1].

2. **Агент анализирует запрос**
    - Агент анализирует ваш вопрос, распознавая, что это запрос, связанный с обслуживанием, который может потребовать данных о шаблонах использования интернета, сетевом трафике и потенциальных нарушениях обслуживания.
    - На основе этого агент определяет соответствующие источники данных, такие как история вашего обслуживания, отчеты о сети и данные о трафике в реальном времени[1].

3. **Агент принимает решение о стратегии извлечения**
    - Агент определяет, какие внешние источники данных запрашивать. В данном случае он может решить:
        - Получить данные из истории вашего аккаунта, чтобы проверить, есть ли какие-либо отмеченные проблемы с обслуживанием.
        - Получить отчеты о сетевом трафике от интернет-провайдера (ISP) для анализа пиковых периодов использования в вашем районе.
        - Запросить общедоступную базу знаний для сбора информации о распространенных причинах вечерних замедлений[1].

4. **Извлечение данных**
    - Система извлечения, управляемая агентом, получает информацию из нескольких источников. Она извлекает:
        - Историю вашего обслуживания, показывающую рост жалоб в вечернее время.
        - Отчеты о сетевом трафике, указывающие на высокую загруженность в вашем районе между 18:00 и 22:00.
        - Статьи из базы знаний, объясняющие, как использование в пиковое время и перегрузка могут вызывать более медленную скорость[1].

5. **LLM генерирует ответ**
    - Как только соответствующие данные извлечены, большая языковая модель (LLM) обрабатывает их. Модель учитывает как свои предварительно обученные знания, так и данные, полученные агентом в реальном времени.
    - LLM генерирует ответ, интегрирующий эти идеи: "Похоже, что скорость вашего интернета замедляется по вечерам из-за высокого трафика в вашем районе в часы пик. Вы можете рассмотреть возможность обновления вашего тарифа или использования интернета в непиковые часы, чтобы избежать перегрузки"[1].

6. **Доставка ответа**
    - Сгенерированный ответ доставляется вам, давая четкое и точное объяснение того, почему ваш интернет медленный по вечерам, основанное как на данных реального времени, так и на общем понимании сетевой перегрузки[1].

7. **Последующие действия**
    - При необходимости агент может продолжать помогать, предлагая дополнительные решения. Например, он может рекомендовать более быстрый тарифный план или назначить визит технического специалиста, если обнаружит какие-либо текущие проблемы с вашим подключением[1].

### Ключевые моменты Агентного RAG в действии:

- **Агент** автономно решает, какие источники запрашивать на основе вашего вопроса.
- **Система извлечения** получает данные реального времени, специфичные для вашего запроса, улучшая ответ LLM.
- **LLM** генерирует ответ, который более точен и учитывает контекст, поскольку интегрирует как предварительно обученные знания, так и свежие данные, полученные агентом[1].

Обратите внимание, что хотя это базовый пример того, как работает Агентный RAG, он также может взаимодействовать не только с базами знаний, но и с другими инструментами и сервисами, аналогично тому, как это делают традиционные агенты[1].

## Возможности Агентного RAG

Агентный RAG предлагает ряд мощных возможностей, которые делают его привлекательным вариантом для систем, требующих динамического извлечения данных и принятия решений в реальном времени. Вот некоторые из выдающихся функций:

### Динамическое извлечение данных

Одной из основных особенностей Агентного RAG является его способность получать информацию в реальном времени на основе запросов пользователей. Включая интеллектуальных агентов, система может решать, какие источники данных запрашивать, обеспечивая получение наиболее релевантной и актуальной информации. Это позволяет давать более точные и контекстуально осведомленные ответы, особенно в средах, где данные часто меняются, например, в новостях или финансах[1].

### Автономное принятие решений

В традиционной настройке RAG процесс извлечения относительно прост. Однако в Агентном RAG интеллектуальные агенты принимают автономные решения на протяжении всего конвейера. Они определяют, какие данные извлекать, когда их извлекать и как их использовать, всё это без необходимости вмешательства человека. Эта автономия делает систему более гибкой и адаптивной, позволяя ей эффективно справляться с широким спектром сложных задач[1].

### Ответы с учетом контекста

Агентный RAG не просто слепо извлекает информацию. Агенты оценивают контекст каждого запроса и соответствующим образом корректируют процесс извлечения. Это означает, что система может адаптировать ответы на основе конкретных потребностей пользователя, улучшая релевантность и точность. Агенты учитывают контекст в реальном времени, позволяя системе более интеллектуально реагировать на нюансированные запросы[1].

### Масштабируемость

С агентами, контролирующими процессы извлечения и принятия решений, Агентный RAG масштабируется более эффективно, чем традиционные системы RAG. Он может обрабатывать более сложные запросы в различных областях, используя несколько источников данных и интеллектуально распределяя рабочие нагрузки. Система разработана для расширения сложности и объема при сохранении производительности, что делает ее пригодной для крупномасштабных приложений, таких как поддержка клиентов или корпоративный поиск[1].

### Снижение риска галлюцинаций

Одной из проблем с традиционными LLM являются галлюцинации, когда модель генерирует неверные или бессмысленные ответы. Поскольку Агентный RAG получает данные в реальном времени и интеллектуально интегрирует их в ответы, вероятность галлюцинаций значительно снижается. Агенты гарантируют, что используемая информация точна и релевантна, уменьшая вероятность того, что система предоставит ложную информацию[1].

### Настраиваемые рабочие процессы

Агентный RAG позволяет создавать высоко настраиваемые рабочие процессы в зависимости от задачи или области. Агенты могут быть настроены на следование различным стратегиям извлечения, приоритизацию определенных источников данных или адаптацию к конкретным бизнес-потребностям. Эта гибкость делает систему высоко универсальной, способной эффективно функционировать в различных отраслях или приложениях[1].

### Многоступенчатое рассуждение

Конвейеры Агентного RAG могут обрабатывать сложные задачи, требующие нескольких шагов для достижения решения. Они могут разбивать запрос пользователя на более мелкие шаги, извлекать данные и постепенно строить ответ, позволяя давать более нюансированные и логичные ответы[1].

## Типы Агентного RAG

Системы Агентного RAG могут быть классифицированы на основе того, как работают агенты и сложности их взаимодействия с компонентами извлечения и генерации. Существует несколько типов, каждый из которых подходит для различных задач и уровней сложности:

### Одноагентный RAG

В этой настройке один интеллектуальный агент отвечает за управление всем процессом извлечения и генерации. Агент решает, какие источники запрашивать, какие данные извлекать и как данные следует использовать при генерации окончательного ответа. Этот тип идеален для более простых задач или систем, где принятие решений не требует большой сложности. Одноагентный RAG эффективен при управлении рутинными запросами с прямолинейными потребностями в извлечении информации[1].

### Многоагентный RAG

Многоагентный RAG включает в себя несколько агентов, работающих совместно, каждый из которых занимается различными аспектами процесса извлечения и генерации. Один агент может заниматься извлечением из конкретного источника, в то время как другой может сосредоточиться на оптимизации интеграции данных в ответ LLM. Многоагентные системы хорошо подходят для более сложных сценариев, когда различные типы данных должны быть получены из различных источников или когда задачи необходимо разбивать на более мелкие, специализированные части[1].

### Иерархический Агентный RAG

В этой настройке агенты организованы в иерархию, где агенты более высокого уровня контролируют и направляют агентов более низкого уровня. Агенты более высокого уровня могут решать, какие источники данных стоит запрашивать, в то время как агенты более низкого уровня фокусируются на выполнении этих запросов и возвращении результатов. Этот тип полезен для очень сложных задач, где требуется стратегическое принятие решений на нескольких уровнях. Например, иерархический Агентный RAG полезен в системах, которым нужно приоритизировать определенные источники данных или балансировать конкурирующие приоритеты[1].

## Реализация Агентного RAG

Вот некоторые ресурсы, которые вы можете использовать, чтобы начать реализацию Агентного RAG:

1. [Реализация Агентного RAG с использованием LangChain](https://medium.com/the-ai-forum/implementing-agentic-rag-using-langchain-b22af7f6a3b5)[1]
2. [GitHub: agentic-rag-langchain-pinecone](https://github.com/benitomartin/agentic-rag-langchain-pinecone)[1]
3. [Агентный RAG с LlamaIndex](https://www.llamaindex.ai/blog/agentic-rag-with-llamaindex-2721b8a49ff6)[1]
4. [Документация LlamaIndex по Агентному RAG с использованием Vertex AI](https://docs.llamaindex.ai/en/stable/examples/agent/agentic_rag_using_vertex_ai/)[1]
5. [Создание систем Агентного RAG с LangGraph](https://www.analyticsvidhya.com/blog/2024/07/building-agentic-rag-systems-with-langgraph/)[1]

## Проблемы и будущие направления Агентного RAG

По мере развития Агентного дополненного генерирования с извлечением (RAG) оно сталкивается с несколькими проблемами, которые необходимо решить для достижения его полного потенциала. В то же время, существуют интересные будущие направления, которые обещают сделать технологию еще более мощной и адаптивной.

### Проблемы:

#### Сложность координации

По мере того как системы интегрируют больше агентов, обеспечение плавной координации между ними становится более сложным. Каждый агент может работать с разными приоритетами, что приводит к потенциальным узким местам или конфликтам в принятии решений. Неэффективная координация может привести к более медленному времени ответа или неполным ответам, если агенты не синхронизируют должным образом свои задачи по извлечению информации[1].

#### Проблемы масштабируемости

Хотя агенты могут сделать системы более гибкими, управление большим количеством агентов и источников данных может быть ресурсоемким. По мере масштабирования системы становится сложнее поддерживать работу в режиме реального времени без ущерба для точности. Высокая задержка ответов и перегруженные конвейеры извлечения могут уменьшить преимущества интеграции данных в реальном времени[1].

#### Качество и надежность данных

Качество извлекаемой информации имеет решающее значение для точности ответов. Если агенты получают данные из ненадежных или низкокачественных источников, это может привести к дезинформации или неточным ответам. Плохое качество данных может подорвать доверие к системе и привести к неверным решениям, особенно в таких критически важных областях, как здравоохранение или финансы[1].

#### Прозрачность принятия решений агентом

Понимание и мониторинг того, как агенты принимают решения относительно извлечения и использования данных, может быть сложным. Без прозрачности трудно гарантировать, что агенты постоянно делают оптимальный выбор. Недостаток прозрачности может привести к эффекту "черного ящика", когда пользователям и разработчикам трудно интерпретировать, почему были приняты определенные решения, что затрудняет отладку и оптимизацию[1].

### Будущие направления:

#### Улучшенное сотрудничество и оркестровка агентов

Будущие системы Агентного RAG будут сосредоточены на лучших методах оркестровки, которые позволят агентам эффективнее сотрудничать. Это включает в себя более умные рабочие процессы, где агенты могут лучше разделять задачи, беспрепятственно общаться и разрешать конфликты без вмешательства человека. Это обеспечит более плавную работу, уменьшение узких мест и обеспечение более быстрых, точных ответов на сложные запросы[1].

#### Гибридные системы человек-агент

В будущем системы могут интегрировать человеческий надзор, где агенты работают автономно, но люди вмешиваются в случаях неопределенности или высоких ставок. Это позволило бы агентам обрабатывать рутинные запросы, в то время как люди занимались бы исключениями или сложными ситуациями. Это объединило бы эффективность агентов с человеческой интуицией и опытом, особенно в областях, где последствия ошибок высоки, таких как юридические или медицинские решения[1].

#### Обучающиеся агенты

Агенты RAG могут стать более адаптивными, включив механизмы обучения. Вместо следования статичным правилам, агенты смогут учиться на прошлых взаимодействиях, улучшая свою способность принимать решения с течением времени. Обучающиеся агенты позволили бы системам развиваться, становясь лучше в обработке новых и сложных запросов по мере накопления опыта, что привело бы к более умным, персонализированным взаимодействиям[1].

#### Агенты с этическим принятием решений

По мере того, как системы Агентного RAG становятся более интегрированными в чувствительные приложения, разработка агентов, которые могут принимать этические решения, станет критически важной. Эти агенты должны будут учитывать такие факторы, как справедливость, смягчение предвзятости и ответственное использование искусственного интеллекта. Агенты с этическим принятием решений помогут уменьшить предвзятость в ответах, обеспечить справедливость в автоматизированных процессах и укрепить доверие к системам искусственного интеллекта, особенно в таких секторах, как правоохранительные органы или социальные службы[1].

![main_agentic_rag.png](https://github.com/aishwaryanr/awesome-generative-ai-guide/blob/main/resources)
